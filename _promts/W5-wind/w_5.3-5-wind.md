# W5.1: QBlade (2h) — projektowanie turbin i farm wiatrowych

> Kierunek: **Odnawialne Źródła Energii (sem. 5)**  
> Przedmiot: **Programy komputerowe w projektowaniu instalacji OZE**  
> Tryb: wykład + pokaz na żywo (demo) + krótkie zadania warsztatowe

**Cele dydaktyczne**
- Zrozumieć miejsce QBlade w ekosystemie narzędzi wiatrowych (od projektowania łopaty po wstępne analizy aeroelastyczne).  
- Umieć przeprowadzić **pełny mini‑workflow**: od polary profilu -> geometrii łopaty -> charakterystyk BEM -> krzywej mocy -> wstępnej oceny obciążeń.  
- Umieć wybrać **właściwe narzędzie** do danego etapu (QBlade vs TOPFARM vs WindPRO vs OpenWind).

**Plan 2h**
1. 0:00–0:15 — Wprowadzenie: rola narzędzi wiatrowych na osi **„profil–łopata–wirnik–farma–bankowalność”**.  
2. 0:15–0:40 — [Porównanie narzędzi: QBlade, TOPFARM, WindPRO, OpenWind](./03-porownanie-narzedzi.md).  
3. 0:40–1:10 — [QBlade – opis i znaczenie dla projektanta](./04-qblade-znaczenie.md) + demo interfejsu.  
4. 1:10–1:55 — [Proces modelowania/projektowania w QBlade](./05-proces-qblade.md): workflow krok‑po‑kroku + checklisty + typowe błędy.  
5. 1:55–2:00 — Podsumowanie, mini‑kolokwium (1 pytanie kontrolne) i zadanie do domu.

---

## [Porównanie narzędzi: QBlade, TOPFARM, WindPRO, OpenWind](./03-porownanie-narzedzi.md)

### 1) Pozycjonowanie narzędzi w łańcuchu projektowym

| Warstwa / Cel | QBlade | TOPFARM | WindPRO | OpenWind |
|---|---|---|---|---|
| **Profil → Łopata → Wirnik** | Generowanie i analiza polars (XFOIL‑like), projekt geometrii łopaty (HAWT/wybrane opcje VAWT), BEM (ustalone i nieustalone), wstępna aeroelastyka | – | – | – |
| **Sterowanie turbiny (strategia TSR/pitch/torque)** | Krzywe sterowania i ocena wpływu na krzywą mocy | – | – | – |
| **Mikrositing / farma / efekty budzące (wake)** | Ograniczone (studia przypadku 1–N turbin, raczej edukacyjnie) | **Optymalizacja farmy** (układ, średnice, wysokości; współpraca z modelami budzących) | **Planowanie, due‑diligence** (energia, hałas, migotanie cienia, środowisko, bankowalność) | **Layout i energia** (modele wake, analizy strat, wersje community/enterprise) |
| **Dane wejściowe / klimat** | Rozkłady wiatru do analizy charakterystyk; scenariusze turbulencji | Róża wiatru, mapy zasobów, integracje z modelami wake | Dane meteo (m.in. WAsP/meso), pomiary masty/LiDAR, biblioteki map | Dane meteo i terenowe, biblioteki NTF/meso, import zasobów |
| **Wyniki „bankowalne”** | Nie – narzędzie badawczo‑projektowe | Zależnie od konfiguracji i modeli | **Tak** (powszechnie akceptowane w due‑diligence) | **Częściowo/Tak** (zależnie od licencji i procedur) |

**Wniosek:** QBlade jest **najmocniejszy** w **dolnej warstwie** (profil–łopata–wirnik, aerodynamika i podstawy aeroelastyki). Do **układów farm** i **bankowalnych analiz** używamy WindPRO/OpenWind (ew. w tandemie z TOPFARM/PyWake/FLORIS do optymalizacji rozkładu turbin).

### 2) Główne domeny fizyczne i modele
- **QBlade:** BEM (z poprawkami strat końcowych/hub), modele przeciągnięcia dynamicznego, modele strat końcowych (np. Prandtla), opcje dla **unsteady** (porywy, yaw/tower shadow), generowanie polars profili dla różnych Re i szorstkości.
- **TOPFARM:** meta‑framework optymalizacji (układ, wysokość, średnica, sterowanie) „podpinany” pod silniki przepływu/wake (np. PyWake/FLORIS).
- **WindPRO:** biblioteka modułów (energia, hałas, cień, AEP, straty; łańcuch bankowalny), integracje z danymi pomiarowymi i modelami mezoskalowymi.
- **OpenWind:** projekt layoutu i produkcji energii, różne modele wake, kontrola ograniczeń (strefy wyłączeń, odległości, hałas/cień w wersjach enterprise).

### 3) Kryteria doboru narzędzia (dla projektanta)
1. **Etap projektu:** koncepcja łopaty/wirnika → **QBlade**; koncepcja farmy i AEP → **OpenWind/WindPRO**; optymalizacja rozmieszczenia → **TOPFARM** (z silnikiem wake).  
2. **Wymagany poziom zaufania:** edukacyjny/rozwojowy vs. **due‑diligence**.  
3. **Dane wejściowe:** dostępność polars, pomiarów meteo, map terenu, klas IEC.  
4. **Czas i licencje:** koszt/licencja vs. open‑source; krzywa uczenia.

**Mini‑ćwiczenie (5 min):** Dla zadanych założeń (farma 20 × 6 MW, teren płaski, róża wiatru z SE–NW), wskaż zestaw narzędzi na **etap koncepcyjny** i **etap bankowalny**. Uzasadnij w 3 zdaniach.

---

## [QBlade – opis i znaczenie dla projektanta](./04-qblade-znaczenie.md)

### Co oferuje QBlade?
- **Łańcuch „od profilu do wirnika” w jednym GUI:**
  - **Polary profili** (generacja/import; badanie wpływu Re i chropowatości, krzywych Cl/Cd/Cm vs. α).  
  - **Projekt łopaty:** definicja rozkładu profili po promieniu, **twist**, **chord**, taper, grubość, reguły przejścia root→mid→tip.  
  - **Analizy BEM:** krzywe **Cp–λ**, **C_T**, **moment–ω**, **P–V**, wpływ strat końcowych, korekcje w obszarze root/hub.  
  - **Sterowanie:** krzywe **TSR‑tracking**, **pitch** i **torque law** (Region II/III), ocena **rated power** i marginesów.  
  - **Unsteady & aeroelastyka (wstępna):** porywy, yaw misalignment, cień wieży, przeciągnięcie dynamiczne; wstępne wibracje i separacja 1P/3P.
- **Tryb edukacyjno‑badawczy:** szybkie iteracje koncepcji łopaty (zmiana profilu/twistu → natychmiastowy wpływ na Cp i krzywą mocy).  
- **Mosty do innych narzędzi:** eksport krzywej mocy/łopaty i wyników do dalszych analiz (np. farmowych lub zaawansowanej aeroelastyki).

### Dlaczego QBlade jest ważny w pracy projektanta?
- **Szybka pętla eksperymentu:** pozwala „wyczuć” kompromisy: wydajność **vs.** margines przeciągnięcia, sztywność **vs.** masa, TSR **vs.** hałas/obciążenia.  
- **„Brakujący most” między teorią a praktyką:** studenci/praktycy widzą, jak **mikro‑decyzje** (np. profil na 70% promienia) kształtują **makro‑parametry** (AEP, obciążenia).  
- **Wartość dydaktyczna i R&D:** idealne do **wstępnego trimowania** projektu, zanim uruchomimy droższe i bardziej złożone łańcuchy narzędziowe.

### Typowe przypadki użycia
1. **Dobór profili i rozkładu skrętu/chordu** pod założony **TSR** i klasę wiatru.  
2. **Kalibracja sterowania** (TSR/pitch) do uzyskania płaskiej mocy nominalnej i stabilnych momentów.  
3. **Analiza wrażliwości** (Cp i AEP) na: zmiany polars, chropowatość krawędzi, tolerancje produkcyjne (twist/chord).  
4. **Wstępna ocena obciążeń**: rozkłady sił wzdłuż promienia, trendy w momentach, zgodność z założeniami projektowymi.  

### Ograniczenia (świadome użycie)
- **Bankowalność:** wyniki QBlade nie zastępują pełnych analiz due‑diligence.  
- **Wake/farma:** możliwości ograniczone; do farm stosujemy narzędzia dedykowane.  
- **Model strukturalny:** przydatny do trendów i separacji częstotliwości, lecz nie zastępuje wysokiej wierności MES/aeroelastyki.

**Pytanie kontrolne:** Jak zmiana **TSR_design** z 7 na 9 wpływa na **rozklad chord/twist** i **Cp_max** dla tej samej średnicy? (Odpowiedz jakościowo.)

---

## [Proces modelowania/projektowania w QBlade](./05-proces-qblade.md)

Poniżej **praktyczna checklista** krok‑po‑kroku (z notatkami „co sprawdzić” i „na czym można się wyłożyć”).

### Krok 0 — Założenia projektowe
- **Cele:** moc nominalna, średnica/obrys, TSR_design, typ sterowania (stały kąt/pitch/TSR), klasa wiatru/warunki Re.  
- **Wejścia:** wstępna róża wiatru (dla AEP), gęstość powietrza, ograniczenia hałasu i prędkości obwodowej na końcówce.  
- **Notatka:** zbyt ambitny **TSR_design** bez adekwatnych polars = ryzyko przeciągnięcia i wibracji.

### Krok 1 — Polary profili (biblioteka)
1. **Wybór profili** (root/mid/tip) o rosnącej smukłości ku końcówce.  
2. **Generacja/import polars** dla reprezentatywnych **Re** i poziomów szorstkości; sprawdź płynność **Cl(α)** i **Cd(α)** oraz obszar przeciągnięcia.  
3. **Walidacja jakości:**
   - Gładkie przebiegi **Cl/Cd/Cm** – brak nierealnych „zębów”.  
   - Zakres **α** pokrywa planowane operacje (± góra zapasu).  
4. **Pułapka:** Polary zbyt optymistyczne (laboratoryjne, lśniąca krawędź) zawyżą Cp i AEP.

### Krok 2 — Geometria łopaty
1. **Parametryzacja:** rozkład **chord(r)** i **twist(r)**, wybór profili po promieniu, root fillet, taper ratio.  
2. **Ograniczenia:** maks. chord przy piaście, minimalny twist przy końcówce, grubość → sztywność.  
3. **Szybka iteracja:** zmień twist o ±1–2° na segmentach 60–90%R i obserwuj wpływ na **Cp–λ** i **C_T**.  
4. **Pułapka:** zbyt mała grubość w mid‑span = problemy strukturalne i zmiana polars vs. projektowane.

### Krok 3 — Ustawienia BEM
1. **Straty końcowe/hub** (np. korekcja Prandtla).  
2. **Współczynnik indukcji i modele korekcyjne** (ogranicz zbyt agresywny **a**).  
3. **Siatka promieniowa i azymutalna:** wystarczająca gęstość na 70–95%R (obszar maks. kontrybucji do mocy).  
4. **Walidacja:** zbieżność wyników przy zagęszczaniu siatki.

### Krok 4 — Sterowanie i krzywa mocy
1. **Strategia:**
   - **Region II:** TSR‑tracking lub sterowanie momentem (M ∝ ω²).  
   - **Region III:** pitch‑to‑feather utrzymujący **P_rated**.  
2. **Wyjścia:** krzywa **P(v)**, **Cp(λ)**, **η_generator**, prędkość obwodowa **V_tip**.  
3. **Testy brzegowe:** wiatr niski (start‑up), wiatr bliski cut‑out (stabilność).  
4. **Pułapka:** płytka charakterystyka pitch w Regionie III → wahania mocy i wzrost obciążeń.

### Krok 5 — Analizy nieustalone i efekty drugorzędowe
1. **Gust/turbulencja, yaw misalignment, cień wieży** – symulacje czasowe; obserwuj momenty i kąty natarcia na sekcjach.  
2. **Przeciągnięcie dynamiczne** – sprawdź modele i parametry; identyfikuj „klapy” Cl i skoki momentu.  
3. **Wnioski:** gdzie dodać **twist relief** lub zmienić profil, by ograniczyć pikowanie obciążeń.

### Krok 6 — Wstępna aeroelastyka/struktura
1. **Rozkład EI (zginanie) i GJ (skręcanie)** – wprowadź przybliżone dane materiałowe/warstwowe.  
2. **Częstotliwości własne** – unikaj rezonansów z 1P/3P i wyższymi harmonicznymi.  
3. **Trend obciążeń** – porównaj momenty na root i mid‑span między wariantami.  
4. **Pułapka:** zbyt „miękka” końcówka → coupling skręcanie–zginanie i „flap‑lag”.

### Krok 7 — AEP i scenariusze eksploatacyjne
1. **Integracja P(v) z rozkładem prędkości** (róża wiatru, Weibull) → **AEP** wariantów.  
2. **Straty:** brudzenie krawędzi, dostępność, curtailment, wake (jeśli 2+ turbin).  
3. **Raporty:** krzywa mocy, Cp–λ, rozkłady sił, zalecenia sterowania.

### Krok 8 — Przygotowanie eksportów i dokumentacja
- **Eksport geometrii łopaty**, profili i krzywych do dalszych narzędzi (farma/aeroelastyka).  
- **Checklisty jakości:** zgodność założeń ↔ wyniki, kompletność metadanych (Re, szorstkość, modele).  
- **Ścieżka wersjonowania:** warianty nazwij konsekwentnie (np. *D120_TSR8_v03*).

---

## Dobre praktyki i typowe błędy

**Dobre praktyki**
- Waliduj **polary** na kilku Re i z marginesem α.  
- Zawsze rysuj **Cp–λ** i **C_T** dla kilku wariantów twist/chord (od razu widać trade‑offy).  
- Sprawdzaj **V_tip** i ograniczenia hałasu (wynikowa ω dla danego TSR i D!).  
- Utrzymuj odstęp częstotliwości własnych od 1P/3P.  
- Dokumentuj **modele** (indukcja, dynamic stall, tip/hub losses).

**Typowe błędy**
- Zbyt „idealne” polary → **przeszacowany AEP**.  
- Brak korekcji strat końcowych → zawyżony **C_T** i błędne obciążenia.  
- Nieciągły twist przy 60–80%R → lokalne piki α i dynamic stall.  
- Ignorowanie yaw/tower shadow → zaskoczenie w nieustalonych momentach.  
- Brak kontroli **Region III** → zbyt duże wahania mocy przy silnym wietrze.

---

## Materiały do samodzielnej pracy (zadanie domowe)
1. Zbuduj dwa warianty łopaty dla tej samej średnicy i **TSR_design**:  
   **W1:** profil tip „smukły” i większy twist relief; **W2:** profil tip „łagodniejszy” i mniejszy twist relief.  
   Porównaj: **Cp–λ**, **P(v)**, rozkład momentów oraz wrażliwość na porywy.  
2. Zaproponuj krzywą **pitch** dla Regionu III, która minimalizuje wahania mocy przy 12–20 m/s.  
3. Przygotuj krótką notatkę (max 1 str.) z wnioskami i rekomendacjami (który wariant wybrać i dlaczego).

---

## Słowniczek (skrótowo)
- **BEM** – Blade Element Momentum; łączy teorię elementów łopaty z bilansem pędu.  
- **Cp** – współczynnik mocy; **λ (TSR)** – stosunek prędkości końcówki do wiatru.  
- **C_T** – thrust coefficient; istotny dla obciążeń i efektów wake.  
- **Dynamic stall** – przeciągnięcie dynamiczne; przejściowe zjawiska w nieustalonych warunkach.  
- **1P/3P** – harmoniczne związane z prędkością obrotową (na łopatę i na wirnik).

---

### Checklista przed „puszczeniem” wariantu dalej w łańcuch
- [ ] Polary: zakres α i Re adekwatny; brak artefaktów.  
- [ ] Geometria: twist/chord ciągłe, sensowny taper, profile po promieniu.  
- [ ] BEM: ustawione straty tip/hub i zbieżność siatki.  
- [ ] Sterowanie: Region II/III zdefiniowany; brak overshootów mocy.  
- [ ] Unsteady: yaw/cień wieży sprawdzone jakościowo.  
- [ ] Struktura: częstotliwości własne poza 1P/3P.  
- [ ] Raport: Cp–λ, P(v), rozkłady sił, notatka z wnioskami.

---

> **Na kolejnych zajęciach (W5.2)** przejdziemy od pojedynczego wirnika do **wstępnych analiz farmowych** (wake, straty, wprowadzenie do narzędzi planistycznych i optymalizacyjnych).

